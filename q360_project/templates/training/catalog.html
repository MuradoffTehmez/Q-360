{% extends 'base/base.html' %}
{% load i18n static %}

{% block title %}{% trans "Training Catalog" %}{% endblock %}

{% block content %}
<div class="py-4">
    <h2><i class="fas fa-book"></i> {% trans "Training Catalog" %}</h2>

    <div class="row mt-4">
        <div class="col-md-3">
            <div class="card">
                <div class="card-header"><h6>{% trans "Filters" %}</h6></div>
                <div class="card-body">
                    <div class="mb-3">
                        <label>{% trans "Type" %}</label>
                        <select class="form-select" id="typeFilter">
                            <option value="">{% trans "All" %}</option>
                            <option value="course">{% trans "Course" %}</option>
                            <option value="certification">{% trans "Certification" %}</option>
                            <option value="mentoring">{% trans "Mentoring" %}</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label>{% trans "Difficulty" %}</label>
                        <select class="form-select" id="difficultyFilter">
                            <option value="">{% trans "All" %}</option>
                            <option value="beginner">{% trans "Beginner" %}</option>
                            <option value="intermediate">{% trans "Intermediate" %}</option>
                            <option value="advanced">{% trans "Advanced" %}</option>
                        </select>
                    </div>
                    <button class="btn btn-primary w-100" onclick="loadCatalog()">{% trans "Apply" %}</button>
                </div>
            </div>
        </div>
        <div class="col-md-9">
            <div class="row" id="catalogList"></div>
        </div>
    </div>
</div>

<script>
function loadCatalog() {
    const type = $('#typeFilter').val();
    const difficulty = $('#difficultyFilter').val();
    $.get('/api/training/resources/', {type, difficulty_level: difficulty}, function(data) {
        let html = '';
        data.results.forEach(r => {
            html += `
                <div class="col-md-6 mb-3">
                    <div class="card h-100">
                        <div class="card-body">
                            <h5>${r.title}</h5>
                            <p class="text-muted small">${r.description}</p>
                            <span class="badge bg-info">${r.type}</span>
                            <span class="badge bg-secondary">${r.difficulty_level}</span>
                            ${r.duration_hours ? `<p class="mt-2"><i class="fas fa-clock"></i> ${r.duration_hours}h</p>` : ''}
                            ${r.cost ? `<p><i class="fas fa-dollar-sign"></i> ${r.cost} AZN</p>` : ''}
                            <a href="/training/resource/${r.id}/" class="btn btn-sm btn-primary">{% trans "View Details" %}</a>
                        </div>
                    </div>
                </div>
            `;
        });
        $('#catalogList').html(html || '<p>{% trans "No trainings found" %}</p>');
    });
}
$(function() { loadCatalog(); });
</script>
{% endblock %}
